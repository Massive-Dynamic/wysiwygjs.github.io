(function(j,q,a,e){var c=function(A,z,x){var y;return function(){if(y){if(!x){return}clearTimeout(y)}var C=this,B=arguments;y=setTimeout(function(){y=null;A.apply(C,B)},z)}};var r=function(y,A,z,x){if(y.addEventListener){y.addEventListener(A,z,x?true:false)}else{if(y.attachEvent){y.attachEvent("on"+A,z)}else{if(y!=j){y["on"+A]=z}}}};var t=function(y,A,z,x){if(y.removeEventListener){y.removeEventListener(A,z,x?true:false)}else{if(y.detachEvent){y.detachEvent("on"+A,z)}else{if(y!=j){y["on"+A]=null}}}};var w=function(z,A,y,x){if(q.createEvent){var B=q.createEvent("Event");B.initEvent(A,y!==e?y:true,x!==e?x:false);z.dispatchEvent(B)}else{if(q.createEventObject){var B=q.createEventObject();z.fireEvent("on"+A,B)}else{if(typeof(z["on"+A])=="function"){z["on"+A]()}}}};var u=function(x){if(x.preventDefault){x.preventDefault()}else{x.returnValue=false}if(x.stopPropagation){x.stopPropagation()}else{x.cancelBubble=true}return false};var o=typeof(Node)!="undefined"?Node.ELEMENT_NODE:1;var g=typeof(Node)!="undefined"?Node.TEXT_NODE:3;var m=function(x,y){var z=y;while(z){if(z===x){return true}z=z.parentNode}return false};var b=function(y,x){if(y.firstChild){return y.firstChild}while(y){if(y==x){return null}if(y.nextSibling){return y.nextSibling}y=y.parentNode}return null};var p=function(x){if(j.getSelection){var y=j.getSelection();if(y.rangeCount>0){return y.getRangeAt(0)}}else{if(q.selection){var y=q.selection;return y.createRange()}}return null};var l=function(x,z){if(!z){return}if(j.getSelection){var y=j.getSelection();y.removeAllRanges();y.addRange(z)}else{if(q.selection){z.select()}}};var h=function(){if(j.getSelection){var B=j.getSelection();if(!B.rangeCount){return false}var y=B.getRangeAt(0).cloneRange();if(y.getBoundingClientRect){var A=y.getBoundingClientRect();if(A&&A.left&&A.top&&A.right&&A.bottom){return{left:parseInt(A.left),top:parseInt(A.top),width:parseInt(A.right-A.left),height:parseInt(A.bottom-A.top)}}var x=y.getClientRects?y.getClientRects():[];for(var z=0;z<x.length;++z){var A=x[z];if(A.left&&A.top&&A.right&&A.bottom){return{left:parseInt(A.left),top:parseInt(A.top),width:parseInt(A.right-A.left),height:parseInt(A.bottom-A.top)}}}}}else{if(q.selection){var B=q.selection;if(B.type!="Control"){var y=B.createRange();if(y.boundingLeft||y.boundingTop||y.boundingWidth||y.boundingHeight){return{left:y.boundingLeft,top:y.boundingTop,width:y.boundingWidth,height:y.boundingHeight}}}}}return false};var i=function(y){if(j.getSelection){var A=j.getSelection();if(A.isCollapsed){return true}return false}else{if(q.selection){var A=q.selection;if(A.type=="Text"){var z=q.selection.createRange();var x=q.body.createTextRange();x.moveToElementText(y);x.setEndPoint("EndToStart",z);return z.htmlText.length==0}if(A.type=="Control"){return false}}}return true};var k=function(B){if(j.getSelection){var z=j.getSelection();if(!z.rangeCount){return[]}var y=[];for(var F=0;F<z.rangeCount;++F){var H=z.getRangeAt(F),A=H.startContainer,I=H.endContainer;while(A){if(A!=B){var J=false;if(z.containsNode){J=z.containsNode(A,true)}else{var E=q.createRange();E.selectNodeContents(A);for(var F=0;F<z.rangeCount;++F){var H=z.getRangeAt(F);if(H.compareBoundaryPoints(H.END_TO_START,E)>=0&&H.compareBoundaryPoints(H.START_TO_END,E)<=0){J=true;break}}}if(J){y.push(A)}}A=b(A,A==I?I:B)}}if(y.length==0&&m(B,z.focusNode)&&z.focusNode!=B){y.push(z.focusNode)}return y}else{if(q.selection){var z=q.selection;if(z.type=="Text"){var y=[];var x=z.createRangeCollection();for(var F=0;F<x.length;++F){var H=x[F],G=H.parentElement(),A=G;while(A){var E=H.duplicate();E.moveToElementText(A.nodeType!=o?A.parentNode:A);if(E.compareEndPoints("EndToStart",H)>=0&&E.compareEndPoints("StartToEnd",H)<=0){var D=false;for(var C=0;C<y.length;++C){if(y[C]!==A){continue}D=true;break}if(!D){y.push(A)}}A=b(A,G)}}if(y.length==0&&m(B,q.activeElement)&&q.activeElement!=B){y.push(q.activeElement)}return y}if(z.type=="Control"){var y=[];var H=z.createRange();for(var F=0;F<H.length;++F){y.push(H(F))}return y}}}return[]};var f=function(){if(j.getSelection){var y=j.getSelection();if(!y.isCollapsed){try{y.collapseToEnd()
}catch(z){}}}else{if(q.selection){var y=q.selection;if(y.type!="Control"){var x=y.createRange();x.collapse(false);x.select()}}}};var d=function(x,B,A){if(j.getSelection){var C=j.getSelection();if(C.modify){for(var z=0;z<B;++z){C.modify("extend","backward","character")}for(var z=0;z<A;++z){C.modify("extend","forward","character")}}else{var y=C.getRangeAt(0);y.setStart(y.startContainer,y.startOffset-B);y.setEnd(y.endContainer,y.endOffset+A);C.removeAllRanges();C.addRange(y)}}else{if(q.selection){var C=q.selection;if(C.type!="Control"){var y=C.createRange();y.collapse(true);y.moveStart("character",-B);y.moveEnd("character",A);y.select()}}}};var s=function(y){if(i(y)){return null}if(j.getSelection){var D=j.getSelection();if(D.rangeCount){var z=q.createElement("div"),x=D.rangeCount;for(var B=0;B<x;++B){var C=D.getRangeAt(B).cloneContents();z.appendChild(C)}return z.innerHTML}}else{if(q.selection){var D=q.selection;if(D.type=="Text"){var A=D.createRange();return A.htmlText}}}return null};var n=function(x,B){if(j.getSelection){var A=j.getSelection();if(m(x,A.anchorNode)&&m(x,A.focusNode)){return true}if(!B){return false}var y=q.createRange();y.selectNodeContents(x);y.collapse(false);A.removeAllRanges();A.addRange(y)}else{if(q.selection){var A=q.selection;if(A.type=="Control"){var y=A.createRange();if(y.length!=0&&m(x,y(0))){return true}}else{var z=q.body.createTextRange();z.moveToElementText(x);var y=A.createRange();if(z.inRange(y)){return true}}if(!B){return false}var y=q.body.createTextRange();y.moveToElementText(x);y.setEndPoint("StartToEnd",y);y.select()}}return true};var v=function(B,D){if(j.getSelection){var y=j.getSelection();if(y.getRangeAt&&y.rangeCount){var E=y.getRangeAt(0);var z=q.createElement("div");z.innerHTML=D;var F=q.createDocumentFragment(),A,x;while((A=z.firstChild)){x=F.appendChild(A)}if(m(B,E.commonAncestorContainer)){E.deleteContents();E.insertNode(F)}else{B.appendChild(F)}if(x){E=E.cloneRange();E.setStartAfter(x);E.collapse(true);y.removeAllRanges();y.addRange(E)}}}else{if(q.selection){var y=q.selection;if(y.type!="Control"){var C=y.createRange();C.collapse(true);var E=y.createRange();if(m(B,E.parentElement())){E.pasteHTML(D)}else{var G=q.body.createTextRange();G.moveToElementText(B);G.collapse(false);G.select();G.pasteHTML(D)}E=y.createRange();E.setEndPoint("StartToEnd",C);E.select()}}}};j.wysiwyg=function(Z){Z=Z||{};var T=Z.element||null;if(typeof(T)=="string"){T=q.getElementById(T)}var P=Z.onKeyDown||null;var ag=Z.onKeyPress||null;var y=Z.onKeyUp||null;var R=Z.onSelection||null;var aa=Z.onPlaceholder||null;var N=Z.onClosepopup||null;var ac=Z.hijackContextmenu||false;var Q=T.nodeName=="TEXTAREA"||T.nodeName=="INPUT";if(Q){var Y="contentEditable" in q.body;if(Y){var F=a.userAgent.match(/(?:iPad|iPhone|Android).* AppleWebKit\/([^ ]+)/);if(F&&420<=parseInt(F[1])&&parseInt(F[1])<534){Y=false}}if(!Y){var I=T;var ad=function(al){return al.replace(/<br[ \/]*>\n?/gi,"<br>\n")};I.value=ad(I.value);var ai=function(){return this};var A=function(){return null};return{legacy:true,getElement:function(){return I},getHTML:function(){return I.value},setHTML:function(al){I.value=ad(al);return this},getSelectedHTML:A,sync:ai,collapseSelection:ai,expandSelection:ai,openPopup:A,closePopup:ai,removeFormat:ai,bold:ai,italic:ai,underline:ai,strikethrough:ai,forecolor:ai,highlight:ai,fontName:ai,fontSize:ai,subscript:ai,superscript:ai,align:ai,format:ai,indent:ai,insertLink:ai,insertImage:ai,insertHTML:ai,insertList:ai}}}var I=null,ak=null;if(Q){I=T;I.style.display="none";ak=q.createElement("DIV");ak.innerHTML=I.value;var K=I.parentNode,z=I.nextSibling;if(z){K.insertBefore(ak,z)}else{K.appendChild(ak)}}else{ak=T}ak.setAttribute("contentEditable","true");var O=(q.all&&!q.addEventListener)?q:j;var S=null;if(Q){var H=ak.innerHTML;S=function(){var al=ak.innerHTML;if(al==H){return}I.value=al;H=al;w(I,"change",false)}}var X;if(aa){var M=false;X=function(){var an=true;var al=ak;while(al){al=b(al,ak);if(!al){}else{if(al.nodeType==o){if(al.nodeName=="IMG"){an=false;break}}else{if(al.nodeType==g){var am=al.nodeValue;if(am&&am.search(/[^\s]/)!=-1){an=false;
break}}}}}if(M!=an){aa(an);M=an}};X()}var V=null,E=null,U=null;if(R){E=function(ao,am,ax){var au=i(ak);var an=k(ak);var aw=(ao===null||am===null)?null:{left:ao,top:am,width:0,height:0};var al=h();if(al){aw=al}if(aw){if(ak.getBoundingClientRect){var ay=ak.getBoundingClientRect();aw.left-=parseInt(ay.left);aw.top-=parseInt(ay.top)}else{var ar=ak,aq=0,ap=0,at=false;do{aq+=ar.offsetLeft?parseInt(ar.offsetLeft):0;ap+=ar.offsetTop?parseInt(ar.offsetTop):0;if(ar.style.position=="fixed"){at=true}}while(ar=ar.offsetParent);aw.left-=aq-(at?0:j.pageXOffset);aw.top-=ap-(at?0:j.pageYOffset)}if(aw.left<0){aw.left=0}if(aw.top<0){aw.top=0}if(aw.width>ak.offsetWidth){aw.width=ak.offsetWidth}if(aw.height>ak.offsetHeight){aw.height=ak.offsetHeight}}else{if(an.length){for(var av=0;av<an.length;++av){var ar=an[av];if(ar.nodeType!=o){continue}aw={left:ar.offsetLeft,top:ar.offsetTop,width:ar.offsetWidth,height:ar.offsetHeight};break}}}R(au,aw,an,ax)};U=c(E,1)}var ae=null;var D=function(am){if(!am){var am=j.event}var al=am.target||am.srcElement;if(al.nodeType==g){al=al.parentNode}if(m(ae,al)){return}aj()};var ab=function(){if(ae){return ae}r(O,"mousedown",D,true);ae=q.createElement("DIV");var am=ak.parentNode,al=ak.nextSibling;if(al){am.insertBefore(ae,al)}else{am.appendChild(ae)}return ae};var aj=function(){if(!ae){return}ae.parentNode.removeChild(ae);ae=null;t(O,"mousedown",D,true);if(N){N()}};r(ak,"focus",function(){if(I){w(I,"focus",false)}});r(ak,"blur",function(){if(S){S()}if(I){w(I,"blur",false)}});var B=null;if(X||S){var C=S?c(S,250,true):null;var ah=function(al){if(X){X()}if(C){C()}};B=c(ah,1);r(ak,"input",B);r(ak,"DOMNodeInserted",B);r(ak,"DOMNodeRemoved",B);r(ak,"DOMSubtreeModified",B);r(ak,"DOMCharacterDataModified",B);r(ak,"propertychange",B);r(ak,"textInput",B);r(ak,"paste",B);r(ak,"cut",B);r(ak,"drop",B)}var J=function(aq,al){if(!aq){var aq=j.event}var an=aq.which||aq.keyCode,ap=String.fromCharCode(an||aq.charCode),am=aq.shiftKey||false,ao=aq.altKey||false,at=aq.ctrlKey||false,ar=aq.metaKey||false;if(al==1){if(P&&P(an,ap,am,ao,at,ar)===false){return u(aq)}}else{if(al==2){if(ag&&ag(an,ap,am,ao,at,ar)===false){return u(aq)}}else{if(al==3){if(y&&y(an,ap,am,ao,at,ar)===false){return u(aq)}}}}if(al==2||al==3){V=null;if(U){U(null,null,false)}}if(al==2&&B){switch(an){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;default:B();break}}};r(ak,"keydown",function(al){return J(al,1)});r(ak,"keypress",function(al){return J(al,2)});r(ak,"keyup",function(al){return J(al,3)});var af=function(ao,al){if(!ao){var ao=j.event}var an=null,am=null;if(ao.clientX&&ao.clientY){an=ao.clientX;am=ao.clientY}else{if(ao.pageX&&ao.pageY){an=ao.pageX-j.pageXOffset;am=ao.pageY-j.pageYOffset}}if(ao.which&&ao.which==3){al=true}else{if(ao.button&&ao.button==2){al=true}}t(O,"mouseup",af);V=null;if(!ac&&al){return}if(U){U(an,am,al)}};r(ak,"mousedown",function(al){t(O,"mouseup",af);r(O,"mouseup",af)});r(ak,"mouseup",function(al){af(al);if(B){B()}});r(ak,"dblclick",function(al){af(al)});r(ak,"selectionchange",function(al){af(al)});if(ac){r(ak,"contextmenu",function(al){af(al,true);return u(al)})}var x=function(aq,ap,an){l(ak,V);if(!n(ak,an)){return false}if(j.getSelection){try{if(q.queryCommandSupported&&!q.queryCommandSupported(aq)){return false}return q.execCommand(aq,false,ap)}catch(ao){}}else{if(q.selection){var am=q.selection;if(am.type!="None"){var al=am.createRange();try{if(!al.queryCommandEnabled(aq)){return false}return al.execCommand(aq,false,ap)}catch(ao){}}}}return false};var G=null;var L=function(){if(q.all||!!j.MSInputMethodContext){G=q.createElement("DIV");ak.appendChild(G)}};var W=function(al){if(G){ak.removeChild(G);G=null}if(B){B()}if(al){f();V=null}else{if(V){V=p(ak)}}};return{getElement:function(){return ak},getHTML:function(){return ak.innerHTML},setHTML:function(al){ak.innerHTML=al;W(true);return this},getSelectedHTML:function(){l(ak,V);if(!n(ak)){return null}return s(ak)},sync:function(){if(S){S()}return this},collapseSelection:function(){f();V=null;return this},expandSelection:function(am,al){l(ak,V);if(!n(ak)){return this}d(ak,am,al);
V=p(ak);return this},openPopup:function(){if(!V){V=p(ak)}return ab()},closePopup:function(){aj();return this},removeFormat:function(){x("removeFormat");x("unlink");W();return this},bold:function(){x("bold");W();return this},italic:function(){x("italic");W();return this},underline:function(){x("underline");W();return this},strikethrough:function(){x("strikeThrough");W();return this},forecolor:function(al){x("foreColor",al);W();return this},highlight:function(al){if(!x("hiliteColor",al)){x("backColor",al)}W();return this},fontName:function(al){x("fontName",al);W();return this},fontSize:function(al){x("fontSize",al);W();return this},subscript:function(){x("subscript");W();return this},superscript:function(){x("superscript");W();return this},align:function(al){L();if(al=="left"){x("justifyLeft")}else{if(al=="center"){x("justifyCenter")}else{if(al=="right"){x("justifyRight")}else{if(al=="justify"){x("justifyFull")}}}}W();return this},format:function(al){L();x("formatBlock",al);W();return this},indent:function(al){L();x(al?"outdent":"indent");W();return this},insertLink:function(al){x("createLink",al);W(true);return this},insertImage:function(al){x("insertImage",al,true);W(true);return this},insertHTML:function(al){if(!x("insertHTML",al,true)){l(ak,V);n(ak,true);v(ak,al)}W(true);return this},insertList:function(al){L();x(al?"insertOrderedList":"insertUnorderedList");W();return this}}}})(window,document,navigator);
(function(e,a,f,g){var c=function(o,C,A){var j,u,y,n,x,l,k,B;n=Math.floor(o*6);x=o*6-n;l=A*(1-C);k=A*(1-x*C);B=A*(1-(1-x)*C);switch(n%6){case 0:j=A,u=B,y=l;break;case 1:j=k,u=A,y=l;break;case 2:j=l,u=A,y=B;break;case 3:j=l,u=k,y=A;break;case 4:j=B,u=l,y=A;break;case 5:j=A,u=l,y=k;break}var z=Math.floor(j*255).toString(16);var m=Math.floor(u*255).toString(16);var w=Math.floor(y*255).toString(16);return"#"+(z.length<2?"0":"")+z+(m.length<2?"0":"")+m+(w.length<2?"0":"")+w};var d=function(h){return h.replace(/[&<>"]/g,function(i){var j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return j[i]||i})};var b=function(G,I,n,l,H,k,w,M,i,u,o,j,q,F,K,p,t){var D=function(Q,R){if(!R){}else{if(Q.getSelectedHTML()){Q.insertLink(R)}else{Q.insertHTML('<a href="'+d(R)+'">'+d(R)+"</a>")}}Q.closePopup().collapseSelection()};var J=function(Q,U){var T=C(k);var V=f('<input type="text" value="'+(U?U.attr("href"):"")+'" />').addClass("wysiwyg-input").keypress(function(W){if(W.which!=10&&W.which!=13){return}if(U){U.attr("href",V.val());Q.closePopup().collapseSelection()}else{D(Q,V.val())}});if(M){V.attr("placeholder",M)}var S=T.click(function(W){if(U){U.attr("href",V.val());Q.closePopup().collapseSelection()}else{D(Q,V.val())}W.stopPropagation();W.preventDefault();return false});var R=f("<div/>").addClass("wysiwyg-toolbar-form").attr("unselectable","on");R.append(V).append(S);return R};var B=function(U){var S=function(ab,aa){var ac='<img id="wysiwyg-insert-image" src="" alt=""'+(aa?' title="'+d(aa)+'"':"")+" />";U.insertHTML(ac).closePopup().collapseSelection();var ad=f("#wysiwyg-insert-image").removeAttr("id");if(u){ad.css({maxWidth:u[0]+"px",maxHeight:u[1]+"px"}).load(function(){ad.css({maxWidth:"",maxHeight:""});var af=ad.width(),ae=ad.height();if(af>u[0]||ae>u[1]){if((af/ae)>(u[0]/u[1])){ae=parseInt(ae/af*u[0]);af=u[0]}else{af=parseInt(af/ae*u[1]);ae=u[1]}ad.attr("width",af).attr("height",ae)}})}ad.attr("src",ab)};var T=f("<div/>").addClass("wysiwyg-toolbar-form").attr("unselectable","on");var X=null,Z=f('<input type="file" />').css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"});if(!j&&e.File&&e.FileReader&&e.FileList){var V=function(ab){if(!ab.type.match("image.*")){return}var aa=new FileReader();aa.onload=function(ad){var ac=ad.target.result;S(ac,ab.name)};aa.readAsDataURL(ab)};X=Z.attr("draggable","true").change(function(ac){var ab=ac.target.files;for(var aa=0;aa<ab.length;++aa){V(ab[aa])}}).on("dragover",function(aa){aa.originalEvent.dataTransfer.dropEffect="copy";aa.stopPropagation();aa.preventDefault();return false}).on("drop",function(ac){var ab=ac.originalEvent.dataTransfer.files;for(var aa=0;aa<ab.length;++aa){V(ab[aa])}ac.stopPropagation();ac.preventDefault();return false})}else{if(o){var Y=Z.change(function(aa){o.call(this,S)});X=f("<form/>").append(Y)}}if(X){f("<div/>").addClass("wysiwyg-browse").html(w).append(X).appendTo(T)}var Q=C(k);var W=f('<input type="text" value="" />').addClass("wysiwyg-input").keypress(function(aa){if(aa.which==10||aa.which==13){S(W.val())}});if(M){W.attr("placeholder",M)}var R=Q.click(function(aa){S(W.val());aa.stopPropagation();aa.preventDefault();return false});T.append(f("<div/>").append(W).append(R));return T};var L=function(Q){var T=function(X,Y){X=f.trim(X||"");Y=f.trim(Y||"");var Z=false;if(X.length&&!Y.length){Z=X}else{if(Y.indexOf("<")==-1&&Y.indexOf(">")==-1&&Y.match(/^(?:https?:\/)?\/?(?:[^:\/\s]+)(?:(?:\/\w+)*\/)(?:[\w\-\.]+[^#?\s]+)(?:.*)?(?:#[\w\-]+)?$/)){Z=Y}}if(Z&&q){Y=q(Z)||""}if(!Y.length&&Z){Y='<video src="'+d(Z)+'" />'}Q.insertHTML(Y).closePopup().collapseSelection()};var R=f("<div/>").addClass("wysiwyg-toolbar-form").attr("unselectable","on");var S=f("<textarea>").addClass("wysiwyg-input wysiwyg-inputtextarea");if(i){S.attr("placeholder",i)}f("<div/>").addClass("wysiwyg-embedcode").append(S).appendTo(R);var V=C(k);var W=f('<input type="text" value="" />').addClass("wysiwyg-input").keypress(function(X){if(X.which==10||X.which==13){T(W.val())}});if(M){W.attr("placeholder",M)}var U=V.click(function(X){T(W.val(),S.val());X.stopPropagation();X.preventDefault();
return false});R.append(f("<div/>").append(W).append(U));return R};var v=function(R,T){var Q=f("<table/>").attr("cellpadding","0").attr("cellspacing","0").attr("unselectable","on");for(var ab=1;ab<15;++ab){var Z=f("<tr/>");for(var S=0;S<25;++S){var U;if(S==24){var aa=Math.floor(255/13*(14-ab)).toString(16);var X=(aa.length<2?"0":"")+aa;U="#"+X+X+X}else{var W=S/24;var V=ab<=8?ab/8:1;var Y=ab>8?(16-ab)/8:1;U=c(W,V,Y)}f("<td/>").addClass("wysiwyg-toolbar-color").attr("title",U).attr("unselectable","on").css({backgroundColor:U}).click(function(){var ac=this.title;if(T){R.forecolor(ac).closePopup().collapseSelection()}else{R.highlight(ac).closePopup().collapseSelection()}return false}).appendTo(Z)}Q.append(Z)}return Q};var y=function(Q,R){switch(Q){case"insertimage":if(!R){return null}return function(S){R(B(h),S)};case"insertvideo":if(!R){return null}return function(S){R(L(h),S)};case"insertlink":if(!R){return null}return function(S){R(J(h),S)};case"bold":return function(){h.bold()};case"italic":return function(){h.italic()};case"underline":return function(){h.underline()};case"strikethrough":return function(){h.strikethrough()};case"forecolor":if(!R){return null}return function(S){R(v(h,true),S)};case"highlight":if(!R){return null}return function(S){R(v(h,false),S)};case"alignleft":return function(){h.align("left")};case"aligncenter":return function(){h.align("center")};case"alignright":return function(){h.align("right")};case"alignjustify":return function(){h.align("justify")};case"subscript":return function(){h.subscript()};case"superscript":return function(){h.superscript()};case"indent":return function(){h.indent()};case"outdent":return function(){h.indent(true)};case"orderedList":return function(){h.insertList(true)};case"unorderedList":return function(){h.insertList()};case"removeformat":return function(){h.removeFormat().closePopup().collapseSelection()}}return null};var C=function(Q){return f("<a/>").addClass("wysiwyg-toolbar-icon").attr("href","#").attr("title",Q.title).attr("unselectable","on").append(Q.image)};var E=function(Q,R,S,T){f.each(H,function(U,X){if(!X){return}if(R===false&&"showstatic" in X&&!X.showstatic){return}if(R===true&&"showselection" in X&&!X.showselection){return}var W;if("click" in X){W=function(Y){X.click(f(Y))}}else{if("popup" in X){W=function(Z){var aa=S();var Y=X.popup(aa,f(Z));T(aa,Z,Y)}}else{W=y(U,function(Y,Z){var aa=S();aa.append(Y);T(aa,Z);aa.find("input[type=text]:first").focus()})}}var V;if(W){V=C(X).click(function(Y){W(Y.currentTarget);if(y(U)){h.getElement().focus()}Y.stopPropagation();Y.preventDefault();return false})}else{if(X.html){V=f(X.html)}}if(V){Q.append(V)}})};var P=function(Q,ae,U,ab){var ad=ae.get(0).offsetParent,W={left:0,top:0},Z=false,R=false,ac=Q.width(),T=ad;while(T){W.left+=T.offsetLeft;W.top+=T.offsetTop;var S=f(T);if(S.css("position")=="fixed"){Z=true}if(S.css("overflow")!="visible"){R=true}T=T.offsetParent}var aa=f(ad||a.body);aa.append(Q);var V=ae.position();U+=V.left;ab+=V.top;if(Z||R){if(U+ac>aa.width()-1){U=aa.width()-ac-1}if(U<1){U=1}}var Y=f(e).width();if(W.left+U+ac>Y-1){U=Y-W.left-ac-1}var X=Z?0:f(e).scrollLeft();if(W.left+U<X+1){U=X-W.left+1}Q.css({left:parseInt(U)+"px",top:parseInt(ab)+"px"})};var s={},N=null;var x=function(W,V,U){var T=function(ac,ag,ad,af,Z,aa,ae){if(!t){return}var ab=N||"";switch(ag){case 8:ab=ab.substring(0,ab.length-1);case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:if(ac){return}ad=false;break;default:if(!ac){return}ab+=ad;break}var Y=t(ab,ag,ad,af,Z,aa,ae);if(typeof(Y)=="object"&&Y.length){var X=f(Q.openPopup());X.hide().addClass("wysiwyg-popup wysiwyg-popuphover").empty().append(Y);N=ab}else{Q.closePopup();N=null;return Y}};var S={element:W.get(0),onKeyDown:function(Z,ab,Y,aa,ad,ac){if(F&&F(Z,ab,Y,aa,ad,ac)===false){return false}if(ab&&!Y&&!aa&&ad&&!ac){var X=ab.toLowerCase();if(!s[X]){return}s[X]();return false}return T(false,Z,ab,Y,aa,ad,ac)},onKeyPress:function(Y,aa,X,Z,ac,ab){if(K&&K(Y,aa,X,Z,ac,ab)===false){return false}return T(true,Y,aa,X,Z,ac,ab)},onKeyUp:function(Y,aa,X,Z,ac,ab){if(p&&p(Y,aa,X,Z,ac,ab)===false){return false
}},onSelection:function(ae,ab,Y,Z){var aa=true,X=null;if(ae){f.each(Y,function(af,ag){if(f(ag).parents("a").length!=0){X=J(Q,f(ag).parents("a:first"));return false}})}if(!ab){aa=false}else{if(X){}else{if(Z){}else{if(N){}else{if(l!="selection"&&l!="top-selection"&&l!="bottom-selection"){aa=false}else{if(ae){aa=false}else{if(Y.length==1&&Y[0].nodeName=="IMG"){aa=false}}}}}}}if(!aa){Q.closePopup();return}var ad;var ac=function(){var aj=ad.outerWidth();var ai=V.offset(),af=f(Q.getElement()).offset();var ah=ab.left+parseInt(ab.width/2)-parseInt(aj/2)+af.left-ai.left;var ag=ab.top+ab.height+af.top-ai.top;P(ad,V,ah,ag)};ad=f(Q.openPopup());if(!ad.hasClass("wysiwyg-popuphover")||(!ad.data("special"))!=(!X)){ad=f(Q.closePopup().openPopup())}if(N){ad.show()}else{if(!ad.hasClass("wysiwyg-popup")){ad.addClass("wysiwyg-popup wysiwyg-popuphover");if(X){ad.empty().append(X).data("special",true)}else{E(ad,true,function(){return ad.empty()},ac)}}}ac()},onClosepopup:function(){N=null},hijackContextmenu:(l=="selection")};if(U){var R=f("<div/>").addClass("wysiwyg-placeholder").html(U).hide();V.prepend(R);S.onPlaceholder=function(X){if(X){R.show()}else{R.hide()}}}var Q=wysiwyg(S);return Q};var z=f("<div/>").addClass("wysiwyg-container");if(I){z.addClass(I)}G.wrap(z);z=G.parent(".wysiwyg-container");var A=false;if(n){A=f("<div/>").addClass("wysiwyg-wrapper").click(function(){h.getElement().focus()});G.wrap(A);A=G.parent(".wysiwyg-wrapper")}var h=x(G,n?A:z,n);if(h.legacy){var G=f(h.getElement());G.addClass("wysiwyg-textarea");if(G.is(":visible")){G.width(z.width()-(G.outerWidth()-G.width()))}}else{f(h.getElement()).addClass("wysiwyg-editor")}var m={};f.each(H,function(Q,S){if(!S||!S.hotkey){return}var R=y(Q);if(!R){return}s[S.hotkey.toLowerCase()]=R;m[Q]=R});if(l!="selection"){var r=l=="top"||l=="top-selection";var O=f("<div/>").addClass("wysiwyg-toolbar").addClass(r?"wysiwyg-toolbar-top":"wysiwyg-toolbar-bottom");E(O,false,function(){var Q=f(h.openPopup());if(Q.hasClass("wysiwyg-popup")&&Q.hasClass("wysiwyg-popuphover")){Q=f(h.closePopup().openPopup())}if(!Q.hasClass("wysiwyg-popup")){Q.addClass("wysiwyg-popup")}return Q},function(V,U,Q){var R=f(U);var W=V.outerWidth();var T=R.offset().left-z.offset().left+parseInt(R.width()/2)-parseInt(W/2);var S=R.offset().top-z.offset().top;if(r){S+=R.outerHeight()}else{S-=V.outerHeight()}if(Q){T=Q.left;S=Q.top}P(V,z,T,S)});if(r){z.prepend(O)}else{z.append(O)}}return{wysiwygeditor:h,$container:z}};f.fn.wysiwyg=function(h,j){if(!h||typeof(h)==="object"){h=f.extend({},h);return this.each(function(){var u=f(this);if(u.data("wysiwyg")){return}var y=h.classes,o=h.placeholder||u.attr("placeholder"),n=(h.toolbar&&(h.toolbar=="top"||h.toolbar=="top-selection"||h.toolbar=="bottom"||h.toolbar=="bottom-selection"||h.toolbar=="selection"))?h.toolbar:"top-selection",x=h.buttons,m=h.submit,v=h.selectImage,A=h.placeholderUrl||null,k=h.placeholderEmbed||null,t=h.maxImageSize||null,p=h.onImageUpload||null,l=h.forceImageUpload&&p,r=h.videoFromUrl||null,w=h.onKeyDown||null,z=h.onKeyPress||null,q=h.onKeyUp||null,s=h.onAutocomplete||null;var B=b(u,y,o,n,x,m,v,A,k,t,p,l,r,w,z,q,s);u.data("wysiwyg",B)})}else{if(this.length==1){var i=this.data("wysiwyg");if(!i){return this}if(h=="container"){return i.$container}if(h=="shell"){return i.wysiwygeditor}}}return this}})(window,document,jQuery);